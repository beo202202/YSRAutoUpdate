##YSRAutoUpdate (백그라운드 자동 업데이트)

---
**22.07.29 ~ 22.12.13**

---
**Solo Developer**

---
`C#` `OpenCV` `Windows API`

---

![화면 캡처 2022-09-23 134449_2](https://github.com/beo202202/YSRAutoUpdate/assets/125543130/3c9c02c1-fe02-4696-b898-55d155eacc3e)
![화면 캡처 2022-09-23 134139](https://github.com/beo202202/YSRAutoUpdate/assets/125543130/ce7cfc41-8fdc-4c62-8e1b-a936afa0ed71)

### Description

- 이전에는 수동으로 원격 작업을 통해 불필요한 시간 및 비용 소요
- 오래된 병원 프로그램의 `수 십에서 천 단위`의 변경된 질병코드 및 병원수가 등의 `DB 업데이트`를 하나 하나 기다리지 않고 `백그라운드 자동 업데이트` 가능

### What i did

- 공공기관(보건소)에 프로그램 배포
- `Windows API` 이용하여 `백그라운드`에서 창 인식, 마우스 클릭
    - `FindWindow` 함수를 사용하여 특정 창을 인식하고, `SendMessage` 함수를 사용하여 해당 창에 메시지를 보내 UI 조작 없이도 작업을 수행
    - 사용자의 개입 없이 `자동화된 작업`을 수행
- `OpenCV` 이용하여 이미지 비교하여, 오류, 완료 등을 인식
    - 프로그램의 오류, 완료, 시작 등의 이미지를 로딩과 저장을 하고 인식
- 메인 로직 동작 시 UI가 멈추지 않도록`Thread` 도입
- `메모리 누수`를 방지하기 위해 리소스를 직접 해제
    - 리소스 해제 전 관련 로직 사용 시 무한 메모리 증식
    - 가비지 컬렉션을 맹신하지 않고 리소스를 해제하여 메모리 사용을 최적화